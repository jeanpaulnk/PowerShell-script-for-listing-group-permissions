# PowerShell script for listing group permissions
The following is a PowerShell script that lists all Distribution Lists (DLs), Dynamic Distribution Lists (DDLs), and Microsoft 365 (M365) groups for which a user can send as or send on behalf:

# Define the user for which you want to check permissions
$user = "user@domain.com"

# Connect to Exchange Online
$UserCredential = Get-Credential
Connect-ExchangeOnline -UserPrincipalName $UserCredential.UserName -Password $UserCredential.GetNetworkCredential().Password

# Get all distribution groups
$distributionGroups = Get-DistributionGroup -ResultSize Unlimited

# Get all Microsoft 365 groups
$m365Groups = Get-UnifiedGroup -ResultSize Unlimited

# Initialize arrays to store results
$sendAsGroups = @()
$sendOnBehalfGroups = @()

# Check each distribution group for Send As and Send on Behalf permissions
foreach ($group in $distributionGroups) {
    $sendAsPermission = Get-ADPermission -Identity $group.Identity -User $user -AccessRights ExtendedRight | Where-Object { $_.ExtendedRights -contains "Send-as" }
    if ($sendAsPermission) {
        $sendAsGroups += $group.Name
    }

    $sendOnBehalfPermission = Get-Mailbox -Identity $group.Identity | Select-Object -ExpandProperty GrantSendOnBehalfTo | Where-Object { $_.PrimarySmtpAddress -eq $user }
    if ($sendOnBehalfPermission) {
        $sendOnBehalfGroups += $group.Name
    }
}

# Check each M365 group for Send As and Send on Behalf permissions
foreach ($group in $m365Groups) {
    $sendAsPermission = Get-ADPermission -Identity $group.Identity -User $user -AccessRights ExtendedRight | Where-Object { $_.ExtendedRights -contains "Send-as" }
    if ($sendAsPermission) {
        $sendAsGroups += $group.DisplayName
    }

    $sendOnBehalfPermission = Get-Mailbox -Identity $group.Identity | Select-Object -ExpandProperty GrantSendOnBehalfTo | Where-Object { $_.PrimarySmtpAddress -eq $user }
    if ($sendOnBehalfPermission) {
        $sendOnBehalfGroups += $group.DisplayName
    }
}

# Output the results
Write-Output "Groups with Send As permission:"
$sendAsGroups | ForEach-Object { Write-Output $_ }

Write-Output "Groups with Send on Behalf permission:"
$sendOnBehalfGroups | ForEach-Object { Write-Output $_ }

# Disconnect from Exchange Online
Disconnect-ExchangeOnline -Confirm:$false

#Note:PS Script generated by Github copilot
